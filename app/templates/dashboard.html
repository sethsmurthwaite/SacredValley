<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sacred Valley</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="app">
        <!-- Top bar -->
        <header class="topbar">
            <h1>Sacred Valley</h1>
            <nav class="tabs">
                <button class="tab active" data-tab="habits">Habits</button>
                <button class="tab" data-tab="path">Path</button>
                <button class="tab" data-tab="clans">Clans</button>
                <button class="tab" data-tab="settings">Settings</button>
            </nav>
            <button id="theme-toggle">Light/Dark</button>
        </header>

        <!-- Tab content -->
        <main class="content">
            <section id="habits" class="tab-content active">
                <div class="user-card">
                    <h2>Welcome, {{ user.username }}</h2>
                    <p>Realm: <strong>{{ user.current_realm }}</strong> â€¢ Progress: {{ user.progress_to_next }}%</p>
                    <div class="progress-bar"><div style="width: {{ user.progress_to_next }}%"></div></div>
                </div>

                <div class="habits-header">
                    <h2>Your Habits</h2>
                    <button id="add-habit-btn" class="add-btn">ï¼‹</button>
                </div>

                {% if habits|length == 0 %}
                    <p>No habits yet. Click ï¼‹ to add one.</p>
                {% else %}
                    <ul class="habit-list">
                    {% for h in habits %}
                        <li class="habit-item" data-id="{{ h.id }}">
                            <input type="checkbox" class="complete-checkbox"
                                   {% if h.last_completion == today %}checked disabled{% endif %}>
                            <div class="habit-info">
                                <strong>{{ h.name }}</strong>
                                <small>{{ h.frequency }} â€¢ +{{ h.progress_value }}%</small>
                                <p class="desc">{{ h.description or "" }}</p>
                            </div>
                            <div class="streak">ðŸ”¥ {{ h.streak_current }}</div>
                        </li>
                    {% endfor %}
                    </ul>
                {% endif %}
            </section>

            <section id="path" class="tab-content">Path tab (coming soon)</section>
            <section id="clans" class="tab-content">Clans tab (coming soon)</section>
            <section id="settings" class="tab-content">Settings tab (coming soon)</section>
        </main>
    </div>

    <!-- Add Habit Modal -->
    <div id="habit-modal" class="modal">
        <div class="modal-content">
            <h2>Add New Habit</h2>
            <form id="habit-form">
                <input type="text" name="name" placeholder="Habit name" required>
                <input type="number" name="progress_value" min="1" max="100" value="10" step="0.5">
                <textarea name="description" placeholder="Description (optional)"></textarea>
                <select name="frequency">
                    <option value="daily">Daily</option>
                    <option value="weekly">Weekly</option>
                </select>
                <div id="repeat-days" style="display:none;">
                    <label><input type="checkbox" name="days" value="1"> Sun</label>
                    <label><input type="checkbox" name="days" value="2" checked> Mon</label>
                    <label><input type="checkbox" name="days" value="4" checked> Tue</label>
                    <label><input type="checkbox" name="days" value="8" checked> Wed</label>
                    <label><input type="checkbox" name="days" value="16" checked> Thu</label>
                    <label><input type="checkbox" name="days" value="32" checked> Fri</label>
                    <label><input type="checkbox" name="days" value="64" checked> Sat</label>
                </div>
                <div class="modal-actions">
                    <button type="submit">Create</button>
                    <button type="button" id="cancel-modal">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>